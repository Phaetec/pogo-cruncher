machine:
  python:
    version: 3.5.0
  services:
    - docker

dependencies:
  override:
    - docker info
#    - docker build -t pogo-cruncher .

test:
  override:
#    - docker run -d -p 8888:8888 -p 5000:5000 pogo-cruncher; sleep 10
#    - curl --retry 10 --retry-delay 5 -v http://localhost:8888
#    - curl --retry 10 --retry-delay 5 -v http://localhost:5000
    - echo "Build executable if branch is master"
    - if [[ $CIRCLE_BRANCH == feature/cd ]]; then make prepare; make image; docker run -i -v $CIRCLE_ARTIFACTS:/code/build/nsis pogo-build; fi

# deployment:
#   binary:
#     branch: feature/cd
#     commands:
#       - make prepare
#       - make image
#       - make binary
#       - ls -al
#       - ls -al build
#       - cp build/nsis/ $CIRCLE_ARTIFACTS

#general:
#  artifacts:
#    - "/artifacts"
#    - "/code/artifacts/"
